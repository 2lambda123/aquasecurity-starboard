# Support National Security Agency - Kubernetes Hardening Guidance

## Overview

It is required to extend starboard security tools capabilities by supporting the NSA - Kubernetes Hardening Guidance

1. A new Cluster compliance controller will be added to starboard
2. This new cluster will track the ClusterComplianceReport CRD for predefine interval
3. The ClusterComplianceReport data subset of checks which is generated by the 2 tools :
   1. Kube-bench
   2. ConfigAudit
4. A new [Compliance Configuration File](#compliance-configuration-file) will be introduced and include the checks mapping between the 2 tools and the compliance controls in our cas is the NSA
5. The ClusterComplianceReport will be composed by the NSA controls , that has been mapped from the tools check
   <br><img src="./nsa-design.png" width="600" alt="nsa-design"><br>

## Solution

### TL;DR;

Add a new starboard controller to support the generation of the compliance report , a.k.a NSA
The controller will ClusterComplianceReport CRD and generate a new report after pre-define interval

1. A new Compliance folder will be introduced to compliance configuration files
2. Each configuration file will hold a list of controls mapped to different check tools (i.e: kube-bench and conf-audit)
3. The Cluster compliance controller reconciliation will trigger a process which produce the ClusterComplianceReport by:
   1. Fetching the CRDs produced by the Kube-bench and conf-audit tools
   2. Read Compliance Configuration File map tools data and controller
   3. create the CRD and store it in the Etcd

### Deep Dive
The below  [NSA Tool Analysis](#nsa-tool-analysis) provides us with the separation of tool to be triggered based on resource kind for the NSA specification.
As seen with the analysis below, in order to make the NSA specification completed, checks need to be used and added to the relevant tools.

### details

- On startup a new compliance controller will be generated with designated RW object and plugin mapper
- After control is created a new compliance report wll be generated an initial report to triggering reconcile loop for ClusterComplianceReport
- The cluster report will be generated with predefine interval , we will use the controller requeue capabilities to generate the report after interval has exceeded
- the compliance report definition/mapping will be defined in a spec file which will be persisted to file system 


Code Changes:
- kube-bench - a new kube-bench config check `nsa-1.0` need to be added with the following checks for `Node` resource kind:
   - new
      - `use a default policy to deny all ingress and egress traffic` check that netowork policy deny all exist
      - `Usege of LimitRange` check the limit range resource has been define
      - `EncryptionConfiguration` check that encryption resource has been set
      - `service mesh usage` check serve mesh is used in cluster

#### Note: in order to check cluster resource existence check we will have to introduce a new functionality to kube-bench

### Deployment consideration
- nsa appshield rego checks should be preloaded with starboard deployment as NSA plugin will be the default tool  
  example :
```yaml
kind: ConfigMap
apiVersion: v1
metadata:
  namespace: starboard-operator
  name: starboard-nsa-config
  annotations:
    # Introduce a way to version configuration schema.
    starboard.plugin.config.version: "v2"
data:
  nsa.imageRef: openpolicyagent/conftest:v0.28.2
  nsa.resources.requests.cpu: 50
  nsa.resources.requests.memory: 50M
  nsa.resources.limits.cpu: 300m
  nsa.resources.limits.memory: 300M
  nsa.policy.3_runs_as_root.rego.rego: "{REGO CODE}"
  nsa.policy.file_system_not_read_only.rego: "{REGO CODE}"
  nsa.policy.2_privileged.rego: "{REGO CODE}"
  nsa.policy.1_host_ipc.rego: "{REGO CODE}"
  nsa.policy.1_host_pid..rego: "{REGO CODE}"
  nsa.policy.1_host_network.rego: "{REGO CODE}"
  nsa.policy.4_runs_with_a_root_gid.rego: "{REGO CODE}"
  nsa.policy.2_can_elevate_its_own_privileges.rego: "{REGO CODE}"
  nsa.policy.7_selinux_custom_options_set.rego: "{REGO CODE}"
  nsa.policy.6_apparmor_policy_disabled.rego: "{REGO CODE}"
  nsa.policy.5_runtime_default_seccomp_profile_not_set.rego: "{REGO CODE}"
  # For each K8s workload type a config hash will be the same.
  nsa.policy.3_runs_as_root.rego.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.file_system_not_read_only.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.2_privileged.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.1_host_ipc.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.1_host_pid.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.1_host_network.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.4_runs_with_a_root_gid.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.2_can_elevate_its_own_privileges.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.7_selinux_custom_options_set.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.6_apparmor_policy_disabled.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
  nsa.policy.5_runtime_default_seccomp_profile_not_set.kinds: "Pod,ReplicationController,ReplicaSet,StatefulSet,DaemonSet,Job,CronJob"
```

### Permission changes:

it is required to update `02-starboard-operator.rbac.yaml` rules to include new permissions
to support the following tracked resources kind by NSA plugin with (get,list and watch):
 ```yaml
- apiGroups: ["networking.k8s.io"]
  resources:
    - networkpolicies
  verbs:
    - get
    - list
    - watch
```
```yaml
- apiGroups: ["apiserver.config.k8s.io"]
  resources:
    - encryptionconfigurations
  verbs:
    - get
    - list
    - watch
```
```yaml
- apiGroups:
      - ""
    resources:
      - limitranges
    verbs:
      - get
      - list
      - watch
```

### NationalSecurityAgency CRD (maybe use short name nsa for crd?):
- a new CRD `nsareports.crd.yaml` will be added to include nsa check report
- CRD structure (proposal):

```yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: clustercompliancereports.aquasecurity.github.io
  labels:
    app.kubernetes.io/managed-by: starboard
    app.kubernetes.io/version: "0.14.1"
spec:
  group: aquasecurity.github.io
  versions:
    - name: v1alpha1
      served: true
      storage: true
      additionalPrinterColumns:
        - jsonPath: .report.type.kind
          type: string
          name: report
          description: The name of the complience report
        - jsonPath: .metadata.creationTimestamp
          type: date
          name: Age
          description: The age of the report
        - jsonPath: .report.summary.failCount
          type: integer
          name: Fail
          priority: 1
          description: The number of checks that failed with Danger status
        - jsonPath: .report.summary.passCount
          type: integer
          name: Pass
          priority: 1
          description: The number of checks that passed
      schema:
        openAPIV3Schema:
          x-kubernetes-preserve-unknown-fields: true
          type: object
  scope: Cluster
  names:
    singular: clustercompliancereport
    plural: clustercompliancereports
    kind: ClusterComplianceReport
    listKind: ClusterComplianceReportList
    categories: []
    shortNames:
      - compliance
```

### 2 types of compliance reports:

- compliance summary report

```json
{
    "apiVersion": "aquasecurity.github.io/v1alpha1",
    "kind": "ClusterComplianceReport",
    "metadata": {
        "annotations": {
            "starboard.aquasecurity.github.io/report-next-generation": "3s"
        },
        "creationTimestamp": "2022-02-13T11:25:28Z",
        "generation": 3,
        "name": "nsa",
        "resourceVersion": "485633",
        "uid": "80049b23-efbe-46a7-b670-9b4b52ddee72"
    },
    "report": {
        "control_check": [
            {
                "failTotal": 9,
                "id": "1.0",
                "name": "Non-root containers",
                "passTotal": 0,
                "severity": ""
            },
            {
                "failTotal": 0,
                "id": "6.0",
                "name": "Ensure kube config file permission",
                "passTotal": 2,
                "severity": ""
            }
            .
            .
            .
        ],
        "summary": {
            "failCount": 25,
            "passCount": 3
        },
        "type": {
            "description": "national security agency - kubernetes hardening guidance",
            "kind": "compliance",
            "name": "nsa",
            "version": "1.0"
        },
        "updateTimestamp": "2022-02-13T11:32:23Z"
    }
}

```
- compliance granular  report
```json
{
  "apiVersion": "aquasecurity.github.io/v1alpha1",
  "kind": "ClusterComplianceReport",
  "metadata": {
    "annotations": {
      "starboard.aquasecurity.github.io/report-next-generation": "3s"
    },
    "creationTimestamp": "2022-02-13T11:25:28Z",
    "generation": 3,
    "name": "nsa",
    "resourceVersion": "485633",
    "uid": "80049b23-efbe-46a7-b670-9b4b52ddee72"
  },
  "report": {
    "control_check": [
      {
        "id": "1.0",
        "name": "Non-root containers",
        "checkResults": [
          {
            "objectKind": "DaemonSet",
            "remediation": "fix a b c",
            "details": [
              {
                "name": "daemonset-kindnet-kindnet-cni",
                "namespace": "kube-system",
                "status": "fail"
              }
            ]
          }
        ]
      },
      {
        "id": "6.0",
        "name": "Ensure kube config file permission",
        "checkResults": [
          {
            "objectKind": "Pod",
            "remediation": "fix d e f",
            "details": [
              {
                "name": "pod-kube-apiserver-local-control-plane-kube-apiserver",
                "namespace": "kube-system",
                "status": "fail"
              }
            ]
          }
        ]
      }
    ],
    "type": {
      "description": "national security agency - kubernetes hardening guidance",
      "kind": "compliance",
      "name": "nsa",
      "version": "1.0"
    },
    "updateTimestamp": "2022-02-13T11:32:23Z"
  }
}
```



### NSA Tool Analysis

| Test                                                                                          | Description                                                                                             | Kind                                                                        | Tool        | Test                                                                                                                          |
|-----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------------------------------------------------------|
| Non-root containers                                                                           | Check that container is not running as root                                                             | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield : <br/>kubernetes/policies/pss/restricted/3_runs_as_root.rego                                                       |
| Immutable container file systems                                                              | check that container root <br/>file system is immutable                                                 | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/general/file_system_not_read_only.rego                                                         |
| Scan container images vulnerabilities                                                         | scan container for vulnerabilities<br/> and misconfiguration                                            | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Trivy       | Trivy                                                                                                                         |
| Privileged container                                                                          | Controls whether Pods can run privileged containers.                                                    | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/2_privileged.rego                                                                 |
| hostIPC                                                                                       | Controls whether containers can share<br/> host process namespaces                                      | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/1_host_ipc.rego                                                                   |
| hostPID                                                                                       | Controls whether containers can share host process namespaces.                                          | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/1_host_pid.rego                                                                   |
| hostNetwork                                                                                   | Controls whether containers can use the host network.                                                   | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/1_host_network.rego                                                               |
| allowedHostPaths                                                                              | Limits containers to specific paths of the host file system.                                            | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | Need to be added to appshield :<br/> https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems |
| readOnlyRootFilesystem                                                                        | Requires the use of a read only root file system                                                        | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/general/file_system_not_read_only.rego                                                         |
| runAsUser , runAsGroup <br/>and supplementalGroups                                            | Controls whether container applications can run <br/>with root privileges or with root group membership | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/restricted/4_runs_with_a_root_gid.rego                                                     |
| allowPrivilegeEscalation                                                                      | Restricts escalation to root privileges.                                                                | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/restricted/2_can_elevate_its_own_privileges.rego                                           |
| seLinux                                                                                       | Sets the SELinux context of the container.                                                              | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/7_selinux_custom_options_set.rego                                                 |
| AppArmor annotations                                                                          | Sets the seccomp profile used to sandbox containers.                                                    | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/baseline/6_apparmor_policy_disabled.rego                                                   |
| seccomp annotations                                                                           | Sets the seccomp profile used to sandbox containers.                                                    | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/pss/restricted/5_runtime_default_seccomp_profile_not_set.rego                                  |
| Protecting Pod service account tokens                                                         | disable secret token been mount ,automountServiceAccountToken: false                                    | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/advance/protecting_pod_service_account_tokens.rego                                             |
| kube-system or kube-public                                                                    | namespace kube-system should should not be used by users                                                | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/advance/protect_core_components_namespace.rego                                                 |
| Use CNI plugin that supports NetworkPolicy API                                                | check cni plugin installed                                                                              | Node                                                                        | Kube-bench  | 5.3.1 Ensure that the CNI in use supports Network Policies (need to be fixed)                                                 |
| Create policies that select <br/>Pods using podSelector and/or the namespaceSelector          | Create policies that select Pods using podSelector<br/> and/or the namespaceSelector                    | Pod,ReplicationController,ReplicaSet,<br/>StatefulSet,DaemonSet,Job,CronJob | Conftest    | appshield: kubernetes/policies/advance/selector_usage_in_network_policies.rego                                                |
| use a default policy to deny all ingress and egress traffic                                   | check that network policy deny all exist                                                                | NetworkPolicy                                                               | Kube-bench  | Add logic to kube-bench <br/>https://kubernetes.io/docs/concepts/services-networking/network-policies/                        |
| Use LimitRange and ResourceQuota<br/> policies to limit resources on a namespace or Pod level | check the limit range resource has been define                                                          | LimitRange                                                                  | Kube-bench  | Add Logic to kube-bench <br/>https://kubernetes.io/docs/concepts/policy/limit-range/                                          |
| TLS encryption                                                                                | control plan disable insecure port                                                                      | Node                                                                        | Kube-bench  | 1.2.19 Ensure that the --insecure-port argument is set to 0                                                                   |
| Etcd encryption                                                                               | encrypt etcd communication                                                                              | Node                                                                        | Kube-bench  | 2.1 Ensure that the --cert-file and --key-file arguments are set as appropriate                                               |
| Kubeconfig files                                                                              | ensure file permission                                                                                  | Node                                                                        | Kube-bench  | 4.1.3, 4.1.4                                                                                                                  |
| Worker node segmentation                                                                      | node segmentation                                                                                       | Node                                                                        | Kube-bench  | Note sure can be tested                                                                                                       |
| Encryption                                                                                    | check that encryption resource has been set                                                             | EncryptionConfiguration                                                     | Kube-bench  | Add Logic to kube-bench https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/                                     |
| Encryption / secrets                                                                          | check encryption provider                                                                               | Node                                                                        | Kube-bench  | 1.2.3 Ensure that the --encryption-provider-config argument is set as                                                         |
| authentication                                                                                | make sure anonymous-auth is unset                                                                       | Node                                                                        | Kube-bench  | 1.2.1 Ensure that the --anonymous-auth argument is set to false                                                               |~~
| Role-based access control                                                                     | make sure -authorization-mode=RBAC                                                                      | Node                                                                        | Kube-bench  | 1.2.7/1.2.8 Ensure that the --authorization-mode argument is not set to AlwaysAllow                                           |
| Audit policy file                                                                             | check that policy is configure                                                                          | Node                                                                        | Kube-bench  | 3.2.1 Ensure that a minimal audit policy is created                                                                           |
| Audit log path                                                                                | check that log path is configure                                                                        | Node                                                                        | Kube-bench  | 1.2.22 Ensure that the --audit-log-path argument is set                                                                       |
| Audit log max age                                                                             | check audit log aging                                                                                   | Node                                                                        | Kube-bench  | 1.2.23 Ensure that the --audit-log-maxage argument is set to 30 or as appropriate                                             |~~
| service mesh usage                                                                            | check service mesh is used in cluster                                                                   | Node                                                                        | Kube-bench  | Add Logic to kube-bench check service mesh existenace                                                                         |


## Open Items
- nsa supprt for CLI (need to discuss implementation)

## Compliance  Configuration File
```yaml
---
name: NSA
description: National Security Agency - Kubernetes Hardening Guidance
controls:
   - name: Non-root containers
     description: ''
     id: '1.0'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV012
   - name: Immutable container file systems
     description: ''
     id: '1.1'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV014
   - name: Preventing privileged containers
     description: ''
     id: '1.2'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV017
   - name: share host process namespaces
     description: ''
     id: '1.3'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV008
   - name: share host process namespaces.
     description: ''
     id: '1.4'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV009
   - name: use the host network
     id: '1.5'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV010
   - name: Requires the use of a read only root file system
     description: ''
     id: '1.6'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV014
   - name: applications can run with root privileges or with root group membership
     description: ''
     id: '1.7'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV029
   - name: Restricts escalation to root privileges.
     description: ''
     id: '1.8'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV001
   - name: Sets the SELinux context of the container.
     description: ''
     id: '1.9'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV002
   - name: Restrict a container's access to resources with AppArmor
     description: ''
     id: '1.10'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV030
   - name: Sets the seccomp profile used to sandbox containers.
     description: ''
     id: '1.11'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV036
   - name: Protecting Pod service account tokens
     description: ''
     id: '1.12'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV037
   - name: Namespace kube-system should should not be used by users
     description: ''
     id: '1.13'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV038
   - name: pod and/or namespace Selectors usage
     description: ''
     id: '2.0'
     resources:
        - Workload
     mapping:
        tool: config-audit
        checks:
           - id: KSV038
   - name: Use CNI plugin that supports NetworkPolicy API
     description: ''
     id: '3.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 5.3.1
   - name: Use a default policy to deny all ingress and egress traffic
     description: ''
     id: '3.1'
     resources:
        - NetworkPolicy
     mapping:
        tool: kube-bench
        checks:
           - id: "<check need to be added>"
   - name: Use LimitRange and ResourceQuota policies to limit resources
     description: ''
     id: '4.0'
     resources:
        - LimitRange
     mapping:
        tool: kube-bench
        checks:
           - id: "<check need to be added>"
   - name: Control plan disable insecure port
     description: ''
     id: '5.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.19
   - name: Encrypt etcd communication
     description: ''
     id: '5.1'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: '2.1'
   - name: Ensure kube config file permission
     description: ''
     id: '6.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 4.1.3
           - id: 4.1.4
   - name: Check that encryption resource has been set
     description: ''
     id: '6.1'
     resources:
        - EncryptionConfiguration
     mapping:
        tool: kube-bench
        checks:
           - id: "<check need to be added>"
   - name: Check encryption provider
     description: ''
     id: '6.2'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.3
   - name: Make sure anonymous-auth is unset
     description: ''
     id: '7.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.1
   - name: Make sure -authorization-mode=RBAC
     description: ''
     id: '7.1'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.7
           - id: 1.2.8
   - name: Audit policy is configure
     description: ''
     id: '8.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 3.2.1
   - name: Audit log path is configure
     description: ''
     id: '8.1'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.22
   - name: Audit log aging
     description: ''
     id: '8.2'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: 1.2.23
   - name: service mesh is configure
     description: ''
     id: '9.0'
     resources:
        - Node
     mapping:
        tool: kube-bench
        checks:
           - id: "<check need to be added>"
```
### spec file example
```yaml
---
kind: compliance
name: NSA
description: National Security Agency - Kubernetes Hardening Guidance
version: 1.0
generationInterval : 6h
controls:
  - name: Non-root containers
    description: ''
    id: '1.0'
    resources:
      - Workload
    mapping:
      tool: config-audit
      checks:
        - id: KSV012
  - name: Immutable container file systems
    description: ''
    id: '1.1'
    resources:
      - Workload
    mapping:
      tool: config-audit
      checks:
        - id: KSV014
 ....
```
### Next Steps
- POC NSA controller
- need to solve a bug to log conftest ID , it is logging title instead
- inconsistency between cis-kube-bench and conf-audit check tests 
  - conf-audit only show pass summary and do not log pass check
  - cis-kube-bench log pass checks and summary
- Enhance POC code and make it production ready
- Fix and Add tests
- Completed all missing check from appshield - Done
- Add support for nsa 1.0 spec in kube-bench
- Completed missing checks in kube-bench
- Add support for starboard CLI