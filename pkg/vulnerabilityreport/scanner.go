package vulnerabilityreport

import (
	"io"

	"github.com/aquasecurity/starboard/pkg/docker"

	"github.com/aquasecurity/starboard/pkg/apis/aquasecurity/v1alpha1"
	corev1 "k8s.io/api/core/v1"
)

// Scanner defines methods implemented by vulnerability scanner vendors.
type Scanner interface {

	// GetPodSpec describes the pod that will be created when executing a scan job
	// for the specified pod descriptor and container registry credentials.
	GetPodSpec(spec corev1.PodSpec, credentials map[string]docker.Auth) (corev1.PodSpec, []*corev1.Secret, error)

	// ParseVulnerabilityScanResult is a callback to parse and convert logs of the pod controlled
	// by a scan job to the Starboard model.
	ParseVulnerabilityScanResult(imageRef string, logsReader io.ReadCloser) (
		v1alpha1.VulnerabilityScanResult, error)
}
